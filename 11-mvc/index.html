<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Javascript Applications</title>
    <meta name="description" content="Learning to organize our app code using Design Patterns and MVC.">

    <link rel="stylesheet" href="../04-css-2/css/reveal.css">
    <link rel="stylesheet" href="../04-css-2/css/theme/jing.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">

    <link rel="stylesheet" href="../04-css-2/lib/css/zenburn.css">
    <link rel="stylesheet" href="../laser.css">
		<script src="../laser.js"></script>

    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? '../04-css-2/css/print/pdf.css' : '../04-css-2/css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <style>
      .flex-col {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      .flex {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
      }
      .flex > img {
        width: 50%;
      }
      .grid {
        display: grid; 
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      }
      .two-col {columns: 2;}
      .three-col {columns: 3;}
      .big-line { line-height: 3.35rem !important;}
      pre {
        padding: 8px !important;
        border-radius: 8px !important;
        background: #3f3f3f;
        position: relative;
      }
      .reveal .slides pre code.large-code {
        font-size: 2.5rem !important;
        line-height: 3rem !important;
        padding: 8px !important;
        border-radius: 8px !important;
      }
      .reveal .slides pre code.med-code {
        font-size: 1.9rem !important;
        line-height: 2.25rem !important;
        padding: 8px !important;
        border-radius: 8px !important;
      }
      .reveal .slides .nosidescroll {
        overflow-x: hidden;
      }
      .livecode {
        max-height: 30vh !important;
      }
      .livecode.serious {
        max-height: 20vh !important;
      }
      .slack-code {
        padding: 1px 6px !important;
        background: #ddd;
        color: rgb(180, 47, 69);
        border-radius: 4px;
      }
      fieldset {
        border: 3px solid #444 !important;
        width: fit-content;
        padding: 1rem !important;
      }
      :not(pre) >  code {
        padding: 4px !important;
        background: lightgrey;
        color: rgb(211, 12, 52);
        border-radius: 8px;
      }
      pre.wrong::before {
        content: 'üö´';
        position: absolute;
        left: -4rem;
        font-size: 4rem;
        top: 2rem;

      }
      pre.correct::before {
        content: '‚úÖ';
        position: absolute;
        left: -4rem;
        font-size: 4rem;
        top: 2rem;

      }
      #ifelse-vid {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        width: 100vw;
        bottom: 0;
        z-index: -9;
      }

      /* d3 force graph */

      circle {
        fill: crimson;
      }
      line {
        stroke: wheat;
        stroke-width: 2px;
        filter: drop-shadow(0 0 1px firebrick);
      }
      text {
        text-anchor: middle;
        font-family: "Helvetica Neue", Helvetica, sans-serif;
        fill: #666;
        font-size: 16px;
      }
      polyline {
        stroke: black;
        stroke-width: 3px;
      }
      .ATL-container {
        position: relative
      }
      .ATL {
        color: white;
        position: absolute;
        font-size: 6rem !important;
        font-weight: bold !important;
        right: 10%;
        top: 10%;
      }
    </style>
  </head>

  <body>
    <div class="reveal">
      <div class="slides">
        <section>
          <section>
            <h1>Javascript Design Patterns</h1>
          </section>
          <section>
            <h2>To understand JS Frameworks...</h2>
            <p>Before we dive into a framework like React, <br>let's explore how to organize code and why... </p>
            <p>also known as Design Patterns: <a href="https://www.gofpatterns.com/">"Gang Of Four"</a> book</p>
            <ul style='columns: 2'>
              <li>Factory Method Pattern</li>
              <li>Command Pattern</li>
              <li>State Pattern</li>
              <li>Strategy Pattern</li>
              <li>Observer Pattern</li>
              <li>Singleton Pattern</li>
            </ul>
          </section>
          <section>
            <h2>The Saga of the Dragon Clicker App</h2>
            <p>A story about being a programmer hired by a needy client</p>
            <p>...and <strong>YOU</strong> are the protagonist!</p>
          </section>
          <section>
            <h2>I'm your Project Manager</h2>
            <ul>
              <li>I've spoken with our client and I'll be sharing the project reqs with you</li>
              <li>This client's needs seem easy we're sticking with vanilla JS (no framework)</li>
              <li>...but there might be some scaling surprises in store...</li>
            </ul>
          </section>
          <section>
            <h2>Project Requirements for Dragon Clicker <sup><a href="https://emojipedia.org/">1</a></sup>, <sup><a href="https://emojigraph.org/">2</a></sup></h2>
            <ul>
              <li>The application should display a üêâ and a number of clicks.</li>
              <li>The number of clicks should increment when the üêâ is clicked.</li>
              <li>Specifics of layout/style are up to you (but keep affordances & UX in mind)</li>
              <li>Open a new Github repo and post your solution there</li>
              <li>Remember events and event listeners?</li>
            </ul>
            <pre><code class="med-code">var elem = document.getElementById('üêâ');
elem.addEventListener('click', function(e){
  //the element has been clicked... 
  // do stuff here, like increment the counter variable
});</code></pre>
          </section>
          <section>
            <h2>How did you solve this?</h2>
            <p class='fragment'>Mutating a global variable in the listener callback works.</p>
            <pre class='fragment'><code class="med-code">var clicks = 0
let dragon = document.getElementById('dragon')
dragon.addEventListener('click', function(e){
  // update our app data:
  clicks += 1
  // rerender what our app displays:
  dragon.innerText = 'üêâ ' + clicks 
});</code></pre>
          </section>
          <section>
            <h2>What do you think of this solution?</h2>
            <p>Is it scaleable?</p>
            <p>Is it easy to manage or add to?</p>
            <p>Could another developer join the project and easily understand the app?</p>
          </section>
          <section>
            <h2>Leveling up our Git Skills</h2>
            <p>Create a short blog post (1 or 2 paragraphs) that explain how you solved this challenge and why</p>
            <h3>Git Project:</h3>
            <ul>
              <li><code>Fork</code> this <a href="https://github.com/JamieVaughn/reflections">/reflections</a> repo</li>
              <li>Create a Markdown file in the 2021 folder with your name as the title (i.e. <code>Joe.md</code>)</li>
              <li>Write your reflections paragraphs in that markdown file</li>
              <li>Remember our markdown syntax?</li>
              <li>Commit your changes to your forked repo</li>
              <li>Open a <code>Pull Request</code> against the original /reflections repo</li>
            </ul>
          </section>
          <section>
            <h2>The Client Called, Reqs have changed üò£</h2>
            <p>It's typical for reqs to change several times over the development lifecycle</p>
            <p>Learn to roll with it & all software development is an iterative process (i.e. many steps)</p>
            <ul><strong>Common Reasons for Req changes:</strong>
              <li>Client's business needs change</li>
              <li>Audience changes and/or new data about the intended audience</li>
              <li>Technical constraints discovered during development</li>
              <li>Security concerns arise</li>
            </ul>
          </section>
          <section>
            <h2>2Ô∏è‚É£ Dragon Duo</h2>
            <ul><strong>Client's new Reqs:</strong>
              <li>Display two üêâs on the screen</li>
              <li>Display the type of each dragon above it</li>
              <ul>
                <li>For example: Fire, Water, Forest dragons... (they like elemental dragons)</li>
              </ul>
              <li>Use CSS to style the different dragon types distinctly</li>
              <li>Show the number of clicks next to each associated dragon</li>
              <li>Click counts should increment independently of each other</li>
            </ul>
          </section>
          <section>
            <h2>How did you solve it?</h2>
            <p>We could just add a second variable and eventListener...</p>
            <p class='fragment'>Although, that's a lot of loose global variables... </p>
            <p class='fragment'>What if we contained the variables in an object?</p>
            <p class='fragment'>Is it too soon to consider some kind of templating function?</p>
            <p class='fragment'>To style the dragon types how about a CSS class like <code>.fire</code>?</p>
            <p class='fragment'>How about using CSS <code>filter: hue-rotate();</code> perhaps?</p>
          </section>
          <section>
            <h2>Reflections</h2>
            <ul>
              <li>Are you happy with your method of üêâ duplication?</li>
              <li>Is it scalable?</li>
              <li>Did you "hard-code" the types?</li>
              <li>Did you duplicate code anywhere?</li>
              <li>Can you share a technique of encapsulation or D.R.Y. coding you used?</li>
              <li>D.R.Y. - Don't Repeat Yourself</li>
              <li class='fragment'>Repeating code twice isn't so bad, but by three times? </li>
              <ul>
                <li class='fragment'>Try using a Factory Pattern or some other duplication pattern</li>
              </ul>
            </ul>
          </section>
          <section>
            <p>The Client Called Again with new Reqs!! üò±</p>
          </section>
          <section>
            <h2>Dragon Arena üèüÔ∏è</h2>
            <ul>
              <li>A topbar <code>nav</code> with a list of 5 dragon types</li>
              <li>A separate area to display the üêâ's themselves (one shown at a time)</li>
              <li>The display area should show the üêâ's type, icon, and click count</li>
              <li>When the dragon type in the <code>nav</code> is clicked, the display area should update to show the data for that üêâ</li>
              <li>The üêâ's click count should persist even if not currently being displayed</li>
              <li>Click count must be unique to each üêâ & increment when clicked</li>
            </ul>
          </section>
          <section>
            <h2>Reminder on Closures</h2>
            <pre><code class="med-code">var nums = [1,2,3];
for (var i = 0; i < nums.length; i++) {
    // This is the number we're on...
    var num = nums[i]
    // We're creating a DOM element for the number
    var elem = document.createElement('div');
    elem.textContent = num;
    // ... and when we click, alert the value of `num`
    elem.addEventListener('click', (function(numCopy) {
        return function() {
            alert(numCopy);
        };
    })(num));
    document.body.appendChild(elem);
};</code></pre>
          </section>
          <section>
            <h2>Reflections</h2>
            <ul>
              <li>How much harder was that?</li>
              <li>How do you like your solution? </li>
              <li>Are there any problems with it that you foresee as it scales?</li>
              <li>Do you think it could adapt easily to yet more changes?</li>
              <li>Do you feel your code is brittle or flexible? Simple or Complicated?</li>
              <li>Were you able to separate out any of your code into distinct chunks with singular jobs? </li>
              <li>(..like modules, functions, data structures)</li>
            </ul>
          </section>
          <section>
            <h2>The Tools vs. The Blueprints</h2>
            <img class="fragment" style="width: 800px;" src="img/tools.jpeg" alt="">
            <figure class="fragment" style="position: absolute; z-index: 1; transform: translate(0%, -116%);">
              <img  src="img/gear_pump.png" alt="">
              <p style="position: absolute; bottom: -18%; background: white;">Subassemblies of Code that slot into an entire application</p>
            </figure>
            <img class="fragment" style="position: absolute; z-index: 0; transform: translate(-60%, 0);" src="img/wind_turbine.jpeg" alt="">
          </section>
          <section>
            <h2>Spaghetti Code</h2>
            <p class='fragment'>... is when a codebase has <strong>many connections</strong> and <strong>no organization</strong></p>
            <div class="flex fragment">
              <svg onclick="addPhone(event)" class='nohub' width="600" height="450" viewBox="200 150 200 160">
                <g class="nohub-links"></g>
                <g class="nohub-nodes"></g>
              </svg>
              <div>
                <p>Number of Phones: <span class="node-annotation">2</span></p>
                <p>Number of Connections: <span class="cxn-annotation">1</span></p>
              </div>
            </div>
            <img class='fragment j-stamp' src="img/sad_spaghet.webp" style="border: none; transform: rotate(-15deg) translate(-70%, 0); clip-path: polygon(50% 0, 100% 0, 100% 100%, 50% 100%, 50% 0)" alt="">
          </section>
          <section>
            <h2>More Connections is More Complexity</h2>
            <p>By the point you have 45 phones you'll have a thousand connections!!!</p>
            <div>
              <svg style="border-left: 1px solid grey; border-bottom: 1px solid grey;" height="200" width="400" viewBox="5 0 200 102">
              <polyline fill="none" points="0,100 10,100 20,99 30,97 40,94 50,90 60,85 70,79 80,72 90,64 100,55 110,45 120,34 130,22 140,9 150,-5" />
                <circle cx="30" cy="97" r="4" />
                <circle cx="60" cy="85" r="4" />
                <circle cx="90" cy="64" r="4" />
                <circle cx="120" cy="34" r="4" />
              </svg>
            </div>
            <p class="fragment">Each of these connections represents a unique function, method or configuration parameters</p>
            <p class="fragment">Exponential relationships are scary and hard to manage!</p>
          </section>
          <section>
            <h2>Managing Connections</h2>
            <ul>
              <li>We need to think carefully about how to organize these connections</li>
              <li>Applications can't work without the parts communicating/connecting...</li>
              <li>But if you connect all parts of your app to every other part:
                <ol>
                  <li>It becomes hard to manage </li>
                  <li>You've lost all degrees of freedom</li>
                  <li>That's called "tightly coupled" code</li>
                  <li>It means you can't rearrange the code without breaking something</li>
                </ol> 
            </ul>
            <p>You won't have <strong>scalable, extensible, stable or clean</strong> code anymore</p>
          </section>
          <section>
            <h2>Adding Organization</h2>
            <p>What if we add something that can manage and route those connections</p>
            <p class='fragment'>...like a <strong>Hub</strong>!</p>
            <div class="flex">
              <svg class='hub fragment' width="600" height="450" viewBox="200 150 200 160">
                <g class="hub-links"></g>
                <g class="hub-nodes"></g>
              </svg>
              <div class="fragment">
                <p>Number of Phones: <span class="node-annotation">15</span></p>
                <p>Number of Connections: <span class="cxn-annotation">15</span></p>
                <p>Number of phones and connections scale linearly!</p>
              </div>
            </div>
            <div style='transform: translate(-36%, 40%) rotate(-15deg);' class="ATL-container fragment j-stamp">
              <img src="img/Atlanta_airport.jpg" alt="" >
              <span class='ATL'>ATL</span>
            </div>
          </section>
          <section>
            <h2>The Benefit</h2>
            <p style='text-align: left;'>The code is...</p>
            <ul>
              <li>Stable - Bug free and handles errors gracefully</li>
              <li>Clean - Code is easily understood by other devs & adheres to standards</li>
              <li>Scalable - Code can accomodate large numbers of users and/or data</li>
              <li>Extensible - Easy to add new features without disrupting old ones</li>
              <li>Loosely Coupled - Easy to remove legacy features without disrupting new ones</li>
            </ul>
          </section>
          <section>
            <h2>A Hub is called a Controller</h2>
            <p>In programming, there is a well established pattern that uses this <br><strong>Hub</strong> approach</p>
            <br>
            <p>It's called the <strong>MVC</strong> pattern</p>
            <p><strong>M</strong>odel - <strong>V</strong>iew - <strong>C</strong>ontroller</p>
          </section>
          <section>
            <h2>*Ô∏è‚É£ Model View Controller</h2>
            <p>How to organize the responsibilites (or concerns) of our code</p>
            <p>MVC/VM/P/*Ô∏è‚É£</p>
            <ul>
              <li>Controllers</li>
              <li>Presenters</li>
              <li>View Models</li>
              <li>*Ô∏è‚É£ (whatever you want to call it, all are very similar concepts)</li>
            </ul>
          </section>
          <section>
            <h2>MVC Pattern</h2>
            <ul>
              <li><strong>Model</strong>: Responsible for the app's data and state</li>
              <li><strong>View</strong>: Responsible for rendering the UI to the screen</li>
              <li><strong>Controller</strong>: Responsible for connecting the Model and the View. Provides the update and feedback logic between them.</li>
            </ul>
          </section>
          <section>
            <h2>Hypothetical Calendar app</h2>
            <ol><strong>Which would be part of the Model?</strong>
              <li>The buttons to sort by month</li>
              <li>The array of dates of events</li>
              <li>The render function to display the calendar area</li>
            </ol>
          </section>
          <section>
            <h2>Video App</h2>
            <ol><strong>Which are part of the view?</strong>
              <li>The array of urls of videos</li>
              <li>The search input element</li>
              <li>the function that adds a URL to a playlist</li>
              <li>the area where the video is displayed</li>
            </ol>
          </section>
          <section>
            <h2>Code-along</h2>
            <p>Let's see how we can use an MVC pattern in a small app!</p>
            <p>We're going to code up a note-taking app</p>
            <p>Check out the repo: <a href="https://github.com/JamieVaughn/note-taker">note-taker</a></p>
          </section>
          <section>
            <h2>Complete these Challenges:</h2>
            <p>Can you extend our MVC app with these new features? <sup><a href="https://github.com/JamieVaughn/note-taker">note-taker</a></sup></p>
            <ol>
              <li>‚òëÔ∏è Add a Delete feature</li>
              <li>‚òëÔ∏è Add a localStorage clear feature</li>
              <li>‚òëÔ∏è Add a timestamp for each note</li>
              <li>Think about where each of these would go in the MVC architecture</li>
              <li>Start to consider if our Dragon Clicker can be architected in a similar way</li>
            </ol>
          </section>
          <section>
            <h2>Our Favorite Client called again üòë</h2>
            <p>They wants us to refactor Dragon Arena üèüÔ∏è using <strong>MVC</strong></p>
          </section>
          <section>
            <h2>Dragon Arena üèüÔ∏è Premium</h2>
            <p>Planning our MVC Refactoring</p>
            <ul>
              <li>App Requirements are same as before, but our implementation will change</li>
              <li>Decide which elements belong in the <strong>M</strong>, the <strong>V</strong> or the <strong>C</strong></li>
              <li>No storing our model in the DOM anymore, use a data type, like an array</li>
              <li>Be sure to generate your List View from your Model, too</li>
              <li>No mutating the model from the View, anymore, route mutations through the controller</li>
              <li>Use a <code>render</code> function that repaints the View after any updates to the model</li>
            </ul>
          </section>
          <section>
            <h2>"View is a Function of State"</h2>
            <img src="img/ui_state.png" alt=""><br>
            <img src="img/function_of_state.png" class="fragment" alt="">
            <img src="img/state_view.png" class="fragment j-stamp" alt="">
          </section>
          <section>
            <h2>Remember Pure Functions and Side Effects?</h2>
            <p>These concepts can organize our MVC pattern</p>
            <ul>
              <li><strong>Pure functions</strong> don't mutate <strong>global State</strong></li>
              <li>They recieve parameters, perform some transformation & then return a value</li>
              <li>The <em>Controller</em> can use (ideally) all <strong>pure functions</strong></li>
              <li>Think of the <em>Controller</em> as the "brains" of the app</li>
              <li><strong>Pure functions</strong> can help us push our <strong>Side Effects</strong> to the "edges" of our app</li>
              <li>A good rule of thumb is to think of the <em>Model</em> and the <em>View</em> as the "edges"</li>
            </ul>
          </section>
          <section>
            <h2>Sorting Our Code into each Part</h2>
            <ul>
              <li>The <em>Model</em> can have all of the:</li>
              <ul>
                <li><strong>Statefulness</strong> (i.e. data that describes the app state)</li>
                <li>Functions w/ side-effects that <strong>create or mutate</strong> the <em>Model</em></li>
              </ul>
              <li>The <em>Controller</em> can have:</li>
              <ul>
                <li>Pure functions that transmit messages between Model & View</li>
                <li>Pure functions that handle calculations & business logic</li>
              </ul>
              <li>The <em>View</em> can have functions that: </li>
              <ul>
                <li>Dispatch user input as <strong>Commands</strong> (i.e. invokes <em>Controller</em> methods)</li>
                <li>Update/mutate/reference the <strong>implicit state of the DOM</strong> (i.e. render UI)</li>
              </ul>
            </ul>
          </section>
          <section>
            <h2>MVC designations for our App's elements</h2>
            <ul style='list-style: none;'>
              <li class='fragment'>1. <strong>The Clickable list of dragons?</strong> </li>
              <li class='fragment'>‚§∑ View <br/> 2. <strong>The Array of the dragon objects?</strong>  </li>
              <li class='fragment'>‚§∑ Model <br/> 3. <strong>The display area for Dragons?</strong>  </li>
              <li class='fragment'>‚§∑ View <br/> 4. <strong>The <code>increment()</code> or <code>getDragons()</code> functions?</strong> </li>
              <li class='fragment'>‚§∑ Controller <br/> 5. <strong>The Array of dragon types?</strong>  </li>
              <li class='fragment'>‚§∑ Model </li>
            </ul>
          </section>
          <section>
            <h2>Our Dragon Model</h2>
            <pre><code class="med-code">const Model = {

    dragonList: [ 
        type1, 
        type2, 
        ... 
    ],

    dragons = [
        {id: 0, type: 'fire', clicks: 0},
        {id: 1, type: 'sky', clicks: 0},
        ...
    ],

    dragonFactory(obj) // could go in Model or Controller
}</code></pre>
<span style="transform: translate(-20%, 100%)" class='fragment j-stamp'>a unique <code>id</code> distinguishes between duplicate types!</span>
          </section>
          <section>
            <h2>Our Dragon View(s?)</h2>
            <div class="flex">
              <div>
                <ol>
                  <li>List of Dragon Types</li>
                  <li>Display area for Dragon Cards</li>
                </ol>
                <img src="https://github.com/JamieVaughn/dragon-clicker/blob/master/dragon-clicker.png?raw=true" alt="">
              </div>
              <div>
                <ul>
                  <li>They are different areas and they are rerendered by different triggers</li>
                  <li>Could it make sense to have two view objects to handle each independently?</li>
                </ul>
              </div>
            </div>
          </section>
          <section>
            <h2>Views</h2>
            <pre><code class="med-code">const View = {
    node,
    initializeView1(),
    templateFactory(list),
    render1()
}

const View2 = {
    node, 
    initializeView2(),
    templateFactory(dragon),
    render2()
}</code></pre>
          </section>
          <section>
            <h2>Our Dragon Controller</h2>
            <pre><code class="med-code">const Controller = {
    init(),
    increment(),
    getList(),
    getDragons(),
    dispatch(type)
    // dragonFactory(obj), // could be here or Model
    // hide
    // filter
    // delete
    // modify etc...
}</code></pre>
          </section>
          <section>
            <h2>Our MVC Blueprint - Let's Build it!!</h2>
            <div class="flex" style="gap: 8px; align-items: stretch;">
              <pre><code class="med-code">const Model = { 
    list: [],
    dragons: [
    {...}, 
    {...},
    ...],
    dragonFactory()
}</code></pre>
              <pre style="flex: 2 0 34%;"><code class="med-code">const View = {
    node,
    init(),
    templateFactory(),
    render()
}
// Could have a
// MainView & ListView</code></pre>
            <pre><code class="med-code">const Controller = {
  init(),
  getList(),
  getDragons(),
  increment(),
  dispatch(type)
}</code></pre>
          </div>
            <p>Could each of these be in a separate js file? Maybe Modules?</p>
          </section>
          <section>
            <h2>Reflections</h2>
            <ul class='big-line'>
              <li>Does <code>View</code> get called within your <code>Model</code>?</li>
              <li>Does <code>Model</code> get called within your <code>View</code>?</li>
              <li>How many times does <code>Controller</code> get called in <code>View</code> and <code>Model</code>?</li>
              <li>How many times does each <code>View</code> and <code>Model</code> get called within <code>Controller</code>?</li>
            </ul>
          </section>
          <section>
            <p>The Client loves <strong>Dragon Arena üèüÔ∏è Premium</strong></p>
            <p class="fragment"><em>But they're insisting one <em style="font-style: normal">f</em>inal req change</em></p>
            <div class="fragment">
              <strong  style="font-size: 4rem;">ü§¶üèΩ‚Äç‚ôÄÔ∏è</strong>
              <p>(last time, I promise)</p>
            </div>
          </section>
          <section>
            <h2>Dragon Dojo üèØ</h2>
            <ul><strong>For this implementation:</strong>
              <li>Each dragon in the list is unique & can't be duplicated</li>
              <li>Add a separate Admin view <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/dialog#result">modal</a> that displays on doubleclicking a dragon</li>
              <li>The Admin view opens a <code>form</code> to update properties for selected dragon</li>
              <li><code>form</code> submission should update the model of the currently selected dragon & the view should reflect the changes</li>
              <li>They should be able to close the Admin view modal w/ or w/o submitting</li>
              <li><strong>Bonus</strong>: Add a new property for each dragon: <code>level</code>, which increases everytime <code>clicks</code> double in size</li>
              <li><strong>Bonus</strong>: use Window.prompt() to ask for and validate a password before opening the Admin view</li>
            </ul>
          </section>

        </section>

  <!-- Dragon Arena Pro Draft (with Modules) -->
      </div>
    </div>


    <script src="../04-css-2/lib/js/head.min.js"></script>
    <script src="../04-css-2/lib/js/caniuse-embed.min.js"></script>
    <script src="../04-css-2/js/reveal.js"></script>

    <script>
      Reveal.initialize({
        dependencies: [
          { src: '../04-css-2/plugin/markdown/marked.js' },
          { src: '../04-css-2/plugin/markdown/markdown.js' },
          { src: '../04-css-2/plugin/notes/notes.js', async: true },
          { src: '../04-css-2/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
        ]
      });
    </script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>

    <script defer>
      let span = document.querySelectorAll('.snippet-btn')
      let snippet = ``
new ClipboardJS(span);
var playing = false
function togglePlay(el) {
  playing ? el.play() : el.pause()
  playing = !playing
}
    </script>
  <script src="https://cdn.jsdelivr.net/npm/d3@7.0.0/dist/d3.min.js"></script>
  <script defer>
    var width = 600, height = 450

var hubNodes = [
  {name: 'üì°'},
	{name: 'üìû'},
	{name: 'üìû'},
	{name: 'üìû'},
	{name: 'üìû'},
	{name: 'üìû'},
	{name: 'üìû'},
	{name: 'üìû'},
	{name: 'üìû'},
	{name: 'üìû'},
	{name: 'üìû'},
	{name: 'üìû'},
	{name: 'üìû'},
	{name: 'üìû'},
	{name: 'üìû'},
	{name: 'üìû'},
]
var noHubNodes = [
  {id: 0, name: 'üìû'},
	{id: 1, name: 'üìû'},
	// {name: 'üìû'},
	// {name: 'üìû'},
	// {name: 'üìû'},
	// {name: 'üìû'},
	// {name: 'üìû'},
	// {name: 'üìû'},
	// {name: 'üìû'},
]

let phones = 2
let nodeAnnotation = document.querySelector('.node-annotation')
let cxnAnnotation = document.querySelector('.cxn-annotation')

function addPhone(e) {
  console.log('phone')
  phones++
  noHubNodes = Array.from({length: phones}).map((i, id) => ({id, name: 'üìû'}))
  noHubLinks = []
  noHubNodes.forEach(node => {
    noHubNodes.forEach(n => {
      if(node !== n) noHubLinks.push({source: node, target: n})
    })
  })
  nodeAnnotation.innerText = noHubNodes.length
  cxnAnnotation.innerText = (noHubNodes.length * (noHubNodes.length - 1)) / 2
  simulation(noHubNodes, noHubLinks)

}

var noHubLinks = []
var hubLinks = []

noHubNodes.forEach(node => {
  noHubNodes.forEach(n => noHubLinks.push({source: node, target: n}))
})

hubNodes.forEach(node => {
  hubLinks.push({source: node, target: hubNodes[0]})
})


var simulation = (nodes, links, flag) => {
  d3.forceSimulation(nodes)
	.force('charge', d3.forceManyBody().strength(-100))
	.force('center', d3.forceCenter(width / 2, height / 2))
	.force('link', d3.forceLink().links(links))
	.on('tick', flag == 'hub' ? tickHub : tickNoHub);
}

function updateLinks(className, links) {
	d3.select(className)
		.selectAll('line')
		.data(links)
		.join('line')
		.attr('x1', function(d) {
			return d.source.x
		})
		.attr('y1', function(d) {
			return d.source.y
		})
		.attr('x2', function(d) {
			return d.target.x
		})
		.attr('y2', function(d) {
			return d.target.y
		});
}

function updateNodes(className, nodes) {
	d3.select(className)
		.selectAll('text')
		.data(nodes)
		.join('text')
		.text(function(d) {
			return d.name
		})
		.attr('x', function(d) {
			return d.x
		})
		.attr('y', function(d) {
			return d.y
		})
		.attr('dy', function(d) {
			return 5
		});
}

function tickHub() {
  updateLinks('.hub-links', hubLinks)
	updateNodes('.hub-nodes', hubNodes)
}
function tickNoHub() {
	updateLinks('.nohub-links', noHubLinks)
	updateNodes('.nohub-nodes', noHubNodes)
}

  simulation(noHubNodes, noHubLinks)
  simulation(hubNodes, hubLinks, 'hub')



    </script>
  </body>
</html>
